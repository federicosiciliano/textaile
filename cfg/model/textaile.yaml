
encoder:
  name: resnet34 #resnet18 #resnet34

  torchvision_params:
    weights: Null
    # -weights:
    #   value: torchvision.models.ResNet34_Weights.DEFAULT
    #   eval: eval

decoder:
  name: resnet34 #resnet18 #resnet34
  #+ backend: torch

  torchvision_params:
    weights: Null

embedding_size: 512

#output_size: 1

optimizer:
  name: Adam
  # params:
  #   lr: 1.0e-1 # 0.2
  #   weight_decay: 5.0e-4

# loss:
#   EncDecLoss:
#     name: LossWithNans
#     params:
#       loss: L1Loss
#   ConceptLoss:
#     name: LossWithNans
#     params:
#       loss: L1Loss

loss:
  EncDecLoss:
    # name: VGGPerceptualLoss
    name: L1Loss #BCELoss #L1Loss #MSELoss
  ConceptLoss:
    name: TextAIleCustomConceptLoss
    params:
      angular_ids: [0,3,6,9,12]
      angular_loss:
        name: AngularL1Loss
      other_loss:
        name: LossWithNans
        params:
          loss: L1Loss #BCELoss #L1Loss #MSELoss
          loss_params:
            reduction: none
  # VAELoss:
  #   name: NormalizedKL_DivergenceLoss
  # DisentagleEmbedding:
  #   name: MSELoss
  # DisentagleConcepts:
  #   name: TextAIleCustomConceptLoss
  #   params:
  #     angular_ids: [0,3,6,9,12]
  #     angular_loss:
  #       name: AngularL1Loss
  #     other_loss:
  #       name: LossWithNans
  #       params:
  #         loss: MSELoss
  #         loss_params:
  #           reduction: none
  

# metrics:
#   - SoftLabelsAccuracy

/log_params:
  on_step: False
  on_epoch: True

#seed: ${exp.seed}

vae: False
step_routing:
  model_input_from_batch: 0
  loss_input_from_batch:
    EncDecLoss:
      target: 0
    ConceptLoss:
      target: 1
    DisentagleEmbedding: {}
    DisentagleConcepts: {}
  loss_input_from_model_output:
    EncDecLoss:
      input: reconstructed_img
    ConceptLoss:
      input: concepts
    # DisentagleEmbedding:
    #   input: new_embedding
    #   target: embedding
    # DisentagleConcepts:
    #   input: new_concepts
    #   target: random_concepts

#vae: True
disentangle: False
# step_routing:
#   model_input_from_batch: 0
#   loss_input_from_batch:
#     EncDecLoss:
#       target: 0
#     ConceptLoss:
#       target: 1
#     VAELoss: {}
#     DisentagleEmbedding: {}
#     DisentagleConcepts: {}
#   loss_input_from_model_output:
#     EncDecLoss:
#       input: reconstructed_img
#     ConceptLoss:
#       input: concepts
#     VAELoss:
#       mu: mu
#       sigma: sigma
#     # DisentagleEmbedding:
#     #   input: new_embedding
#     #   target: embedding
#     # DisentagleConcepts:
#     #   input: new_concepts
#     #   target: random_concepts

+loader_params: loader_params_cfg

+trainer_params: trainer_params_cfg